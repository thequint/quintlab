<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Nehru Story</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no">
<meta name="copyright" content="The Quint">
<meta name="author" content="The Quint">
<meta name="description" content="">
<!-- Favicon -->
<link rel="icon" type="image/x-icon" href="assets/images/favicon/favicon.ico">
<!-- Custom styles for this template -->
<link rel="stylesheet" href="assets/css/base.css" media="all">
<link rel="stylesheet" href="assets/css/animate.css" media="all">
<link rel="stylesheet" href="assets/css/font-awesome.min.css" media="all">
<link rel="stylesheet" href="assets/css/theme.css" media="all">

<!-- <link rel="stylesheet" href="https://fea.assettype.com/thequint/assets/fonts-86f8c78cce.css"> -->
<link rel='stylesheet prefetch' href='https://michael-zhigulin.github.io/mz-codepen-projects/Material%20Design%20UI%20Audio%20Player/font/font.css'>
<link rel="stylesheet" href="assets/css/style.css">

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css?family=Raleway:600,700" rel="stylesheet">

<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>

<body onload="adjust_iframe_height()">
    <div class="main-wrap">
        <section class="container">
            <div class="container--left">
                <div class="player" id="story_img">
                    <div class="like waves-effect waves-light">
                        <i class="icon-heart"></i>
                    </div>
                    <div class="mask"></div>
                    <ul class="player-info info-one">
                        <li class="story_headline">test</li>
                        <li class="sub_headline"></li>
                        <li>5:34</li>
                    </ul>
                    <ul class="player-info info-two">
                        <li class="story_headline">test</li>
                        <li class="sub_headline"></li>
                        <li><span id="duration"></span><i> / </i>5:34</li>
                    </ul>
                    <div id="play-button" class="unchecked">
                        <i class="icon icon-play"></i>
                    </div>
                    <div class="control-row">
                        <div class="waves-animation-one"></div>
                        <div class="waves-animation-two"></div>
                        <div id="pause-button">
                            <i class="icon"></i>
                        </div>
                        <div class="seek-field">
                            <input id="audioSeekBar" min="0" max="334" step="1" value="0" type="range" oninput="audioSeekBar()" onchange="this.oninput()">
                        </div>
                        <div class="volume-icon">
                            <i class="icon-volume-up"></i>
                        </div>
                        <div class="volume-field">
                            <input type="range" min="0" max="100" value="100" step="1" oninput="audio.volume = this.value/100" onchange="this.oninput()">
                        </div>
                    </div>
                </div>
            </div>
            <div class="container--right">
                <div class="box-wrap">
                    <!-- <h1 class="box-headline" id="story_headline"></h1> -->
                    <div class="box-content">
                        <!-- <span id="story_content"></span> -->
                        <span id="typedtext"></span>
                    </div>
                    <!-- <div class="box-audio" id="story_audio"></div> -->
                </div>
            </div>
        </section>
    </div>
    
    <div id="story_audio"></div>
    <!--
    <audio id="audio-player" ontimeupdate="SeekBar()" ondurationchange="CreateSeekBar()" preload="auto" loop>
        <source src="https://michael-zhigulin.github.io/mz-codepen-projects/Material%20Design%20UI%20Audio%20Player/audio/Tim%20Minchin%20%E2%80%94%20Rock%20n%20Roll%20Nerd.ogg" type="audio/ogg">
        <source src="assets/media/audio--light-has-gone-30-jan-1948.mp3" type="audio/mpeg">
    </audio>-->

    <!-- Scripts -->
    <script type="text/javascript" src="assets/js/jquery.min.js"></script>
 <!--   <script src='https://cdnjs.cloudflare.com/ajax/libs/node-waves/0.7.5/waves.min.js'></script>
    <script src="assets/js/index.js"></script>-->
    <script type="text/javascript">
    var type_flag = 0;
    $("#play-button").click(function() {
        
        if($(this).hasClass("unchecked")){
            //alert("yes");
            $(".container--left").addClass("img-animate");
            $(".container--right").addClass("box-width");
            $(".container--right").addClass("add-content");
            if (type_flag == 0) {
                typewriter();
                type_flag = 1;
            }
        }else {
            $(".container--left").removeClass("img-animate");
            $(".container--right").removeClass("box-width");
            $(".container--right").removeClass("add-content");
        }
        adjust_iframe_height();
        
    });

    function getParameterByName(name, url) {
        if (!url) url = window.location.href;
        name = name.replace(/[\[\]]/g, "\\$&");
        var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
            results = regex.exec(url);
        if (!results) return null;
        if (!results[2]) return '';
        return decodeURIComponent(results[2].replace(/\+/g, " "));
    }

    // content array
    var content_array = [{
            'img': 'assets/images/nehru-cover-img01.jpg',
            'headline': 'Tryst With Destiny',
            'sub_headline': 'Jawaharlal Nehru',
            'content': ['Nehru: Whether we are Hindus or Muslims, Sikhs or Christians, whatever we are, none of us can say in his heart of hearts that he has no prejudice and no taint of communalism in his mind or heart.', '“Another word is thrown up a good deal, this SECULAR STATE business. May I beg with all humility those gentlemen who use this word often, to consult some dictionary before they use it? It is brought in at every conceivable step and at every conceivable stage. I just do not understand it. It has a great deal of importance, no doubt. But it is brought in in all contexts, as if by saying that we are a secular State we have done something amazingly generous, given something out of our pocket to the rest of the world, something which we ought not to have done. We have only done something which every country does except a very few misguided and backward countries in the world. Let us not refer to that word in the sense that we have done something very mighty.” '],
            'audio': 'assets/media/audio--light-has-gone-30-jan-1948.mp3'
        },
        {
            'img': 'assets/images/nehru-img02.jpg',
            'headline': 'Tryst With Destiny',
            'sub_headline': 'Jawaharlal Nehru',
            'content': ['#02 Jawaharlal Nehru was the first Prime Minister of India and a central figure in Indian politics before and after independence. Jawaharlal Nehru was the first Prime Minister of India and a central figure in Indian politics before and after independence', 'Jawaharlal Nehru was the first Prime Minister of India and a central figure in Indian politics before and after independence.'],
            'audio': 'assets/media/audio--light-has-gone-30-jan-1948.mp3'

        },
        {
            'img': 'assets/images/nehru-img02.jpg',
            'headline': 'Tryst With Destiny',
            'sub_headline': 'Jawaharlal Nehru',
            'content': ['#03 Jawaharlal Nehru was the first Prime Minister of India and a central figure in Indian politics before and after independence. Jawaharlal Nehru was the first Prime Minister of India and a central figure in Indian politics before and after independence', 'Jawaharlal Nehru was the first Prime Minister of India and a central figure in Indian politics before and after independence.'],
            'audio': 'assets/media/audio--light-has-gone-30-jan-1948.mp3'
        },
        {
            'img': 'assets/images/nehru-img02.jpg',
            'headline': 'Tryst With Destiny',
            'sub_headline': 'Jawaharlal Nehru',
            'content': ['#04 Jawaharlal Nehru was the first Prime Minister of India and a central figure in Indian politics before and after independence. Jawaharlal Nehru was the first Prime Minister of India and a central figure in Indian politics before and after independence', 'Jawaharlal Nehru was the first Prime Minister of India and a central figure in Indian politics before and after independence.'],
            'audio': 'assets/media/audio--light-has-gone-30-jan-1948.mp3'
        }
    ]


    section_id = getParameterByName('id')-1;

    // $("#story_img").html(content_array[section_id].img);
    // $("#story_headline").html(content_array[section_id].headline);

    $(".player").css("background-image","url('"+content_array[section_id].img+"')");

    $(".story_headline").html(content_array[section_id].headline);
    $(".sub_headline").html(content_array[section_id].sub_headline);
    $("#story_content").html(content_array[section_id].content[0] + '<br/><br/>' + content_array[section_id].content[1]);

    $("#story_audio").html('<audio id="audio-player" ontimeupdate="SeekBar()" ondurationchange="CreateSeekBar()" preload="auto" loop><source src="'+ content_array[section_id].audio +'" type="audio/mpeg"></audio>');

    jQuery.loadScript = function (url, callback) {
    jQuery.ajax({
        url: url,
        dataType: 'script',
        success: callback,
        async: true
    });
    }

    $.loadScript('https://cdnjs.cloudflare.com/ajax/libs/node-waves/0.7.5/waves.min.js', function(){
        console.log("script_loaded");
        $.loadScript('https://quintlab.herokuapp.com/dev/nehru-story/assets/js/index.js', function(){
            console.log("script_loaded_2");
        });
    });

    var aText = new Array(
        content_array[section_id].content[0],
        content_array[section_id].content[1]
    );

    console.log(aText);

    var iSpeed = 50; // time delay of print out
    var iIndex = 0; // start printing array at this posision
    var iArrLength = aText[0].length; // the length of the text array
    var iScrollAt = 20; // start scrolling up at this many lines

    var iTextPos = 0; // initialise text position
    var sContents = ''; // initialise contents variable
    var iRow; // initialise current row

    function typewriter() {
        sContents = ' ';
        iRow = Math.max(0, iIndex - iScrollAt);
        var destination = document.getElementById("typedtext");

        while (iRow < iIndex) {
            sContents += aText[iRow++] + '<br /><br />';
        }
        destination.innerHTML = sContents + aText[iIndex].substring(0, iTextPos) + "_";
        if (iTextPos++ == iArrLength) {
            iTextPos = 0;
            iIndex++;
            if (iIndex != aText.length) {
                iArrLength = aText[iIndex].length;
                setTimeout("typewriter()", 500);
            }
        } else {
            setTimeout("typewriter()", iSpeed);
        }
    }
    //typewriter();

    function adjust_iframe_height(){
        var actual_height = document.body.scrollHeight; 
        console.log("height is",actual_height);
        parent.postMessage(JSON.stringify({'msg-type':"resize-iframe", height:actual_height,src:window.location.href}),"*"); 
        //* allows this to post to any parent iframe regardless of domain
    }
    </script>
</body>

</html>